# ğŸ“„ UI é‚è¼¯èˆ‡çµ„ä»¶çµæ§‹ (V1.2 - React é·ç§»ç‰ˆ)

## 1. å°ˆæ¡ˆç›®éŒ„çµæ§‹ (Folder Structure)
æ¡ç”¨åŠŸèƒ½å°å‘çµæ§‹ã€‚æ ¸å¿ƒé‚è¼¯å°è£æ–¼ `store/` (Zustand) èˆ‡ `hooks/` (è‡ªå®šç¾© Hook) ä¸­ï¼Œç¢ºä¿èº«åˆ†é©—è­‰é‚è¼¯å…¨åŸŸçµ±ä¸€ã€‚

```text
src/
â”œâ”€â”€ api/            # å°è£ Axios è«‹æ±‚ (auth.js, users.js, notes.js)
â”œâ”€â”€ store/          # Zustand ç‹€æ…‹ç®¡ç† (useAuthStore.js å„²å­˜ JWT èˆ‡æ¬Šé™)
â”œâ”€â”€ hooks/          # è‡ªå®šç¾© Hooks (useAuth.js, useAxiosInterceptor.js)
â”œâ”€â”€ utils/          # å…±ç”¨å·¥å…· (axiosInstance.js å¯¦ä½œæ””æˆªå™¨)
â”œâ”€â”€ components/     # é€šç”¨ UI çµ„ä»¶ (Navbar, Button, Skeleton)
â””â”€â”€ pages/          # è·¯ç”±é é¢å¯¦é«”
    â”œâ”€â”€ auth/       # Login, Register, DeviceManagement
    â””â”€â”€ notes/      # NoteEditor, PublicWall
```

---

## 2. ä½ˆå±€é‚è¼¯ (Layout Strategy)
* **Main Layout**: ä½¿ç”¨ React Router çš„ `<Outlet />` å¯¦ç¾å·¢ç‹€ä½ˆå±€ã€‚å´é‚Šæ¬„æ‡‰æ ¹æ“š `user_permissions` å‹•æ…‹æ¸²æŸ“åŠŸèƒ½æ¨¡çµ„ã€‚
* **è¨­å‚™ç®¡ç†ä»‹é¢**: æ•´åˆæ–¼ä½¿ç”¨è€…é¸å–®ï¼Œä¸²æ¥ `/auth/devices` APIï¼Œå±•ç¤ºè¨­å‚™æŒ‡ç´‹è³‡è¨Šã€‚

---

## 3. å‰ç«¯è·¯ç”±èˆ‡æ¬Šé™å®ˆè¡› (React Router Guards)
åœ¨ `App.jsx` æˆ–å°ˆå±¬çš„ `ProtectedRoute` çµ„ä»¶ä¸­å¯¦ä½œï¼š
1. **ç™»å…¥æª¢æŸ¥**: è®€å– Zustand Store ä¸­çš„ `accessToken`ã€‚è‹¥å¤±æ•ˆï¼Œå‰‡å˜—è©¦é€éæ””æˆªå™¨éœé»˜åˆ·æ–°ã€‚
2. **è‡ªå‹•å°å‘**: æœªç¶“æˆæ¬Šä½¿ç”¨è€…å­˜å–å—ä¿è­·è·¯å¾‘æ™‚ï¼Œè‡ªå‹•å°å‘è‡³ `/login`ã€‚
3. **è¨­å‚™è­˜åˆ¥**: åœ¨æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–æ™‚ï¼ˆ`useEffect`ï¼‰ï¼Œæ–¼å‰ç«¯ç”Ÿæˆæˆ–è®€å– `device_id`ã€‚

---

## 4. æ ¸å¿ƒçµ„ä»¶é–‹ç™¼é‚è¼¯ (React Logic)
### 4.1 è¨­å‚™ç®¡ç†çµ„ä»¶ (DeviceManager.jsx)
* **ç‹€æ…‹ç®¡ç†**: ä½¿ç”¨ `useState` ç®¡ç†è¨­å‚™åˆ—è¡¨ï¼Œ`useEffect` è§¸ç™¼ API è«‹æ±‚ã€‚
* **äº’å‹•**: æä¾›ã€Œå¼·åˆ¶è¸¢é™¤ã€æŒ‰éˆ•ï¼Œå‘¼å« `DELETE /auth/devices/{id}` ä¸¦é‡æ–°ç²å–åˆ—è¡¨ã€‚

### 4.2 å€å¡Šç·¨è¼¯å™¨çµ„ä»¶ (NoteEditor.jsx)
* **ç·¨è¼¯å™¨åˆå§‹åŒ–**: ä½¿ç”¨ `useRef` ç¶å®š Editor.js å¯¦ä¾‹ï¼Œç¢ºä¿çµ„ä»¶é‡æ–°æ¸²æŸ“æ™‚ä¸é‡è¤‡åˆå§‹åŒ–ã€‚
* **è‡ªå‹•å„²å­˜**: ç›£è½è®Šå‹•ä¸¦é¡¯ç¤º `Saving...` ç‹€æ…‹ï¼Œç¢ºä¿ JSON åŒæ­¥è‡³å¾Œç«¯ã€‚

---

## 5. UI äº¤äº’ç´°ç¯€ (UX Enhancements)
### 5.1 ç„¡æ„Ÿ Token åˆ·æ–° (Silent Refresh)
* **Axios æ””æˆªå™¨å¯¦ä½œ**:
    1. ç•¶ Axios æ”¶åˆ° `401 Unauthorized` éŒ¯èª¤ä¸”éç™»å…¥è«‹æ±‚æ™‚ã€‚
    2. è‡ªå‹•å¾ Zustand Store æå– `{user_id, device_id, refresh_token}`ã€‚
    3. åŸ·è¡Œ `POST /auth/refresh`ã€‚
    4. **æˆåŠŸ**: æ›´æ–° Store çš„ Token ä¸¦é‡ç™¼åŸæœ¬å¤±æ•—çš„è«‹æ±‚ã€‚
    5. **å¤±æ•—**: æ¸…é™¤æ‰€æœ‰ Store ç‹€æ…‹ï¼ˆLogoutï¼‰ä¸¦å°å‘è‡³ç™»å…¥é ã€‚

### 5.2 éŸ¿æ‡‰å¼è¨­å‚™è­˜åˆ¥
* ç™»å…¥è¡¨å–®æä¾›å¯é¸çš„ `device_name` æ¬„ä½ï¼ˆä¾‹å¦‚ï¼šå®¶ä¸­çš„ç­†é›»ï¼‰ã€‚

### 5.3 éª¨æ¶å± (Skeleton Screens)
* ä½¿ç”¨ Ant Design æä¾›çš„ `<Skeleton />` çµ„ä»¶ï¼Œåœ¨ React Query è™•æ–¼ `isLoading` ç‹€æ…‹æ™‚é€²è¡Œä½”ä½æ¸²æŸ“ã€‚